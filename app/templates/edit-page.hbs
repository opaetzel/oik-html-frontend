{{#top-menu}}
    {{model.page.title}} [Editieren]
{{/top-menu}}
<div class="container">
    {{#each model.page.rows as |row index|}}
        <div class="row equal">
        <div class="delete-row">
            <a class="" {{action "deleteRow" row}} title="Zeile löschen"><i class="glyphicon glyphicon-trash"></i></a>
            </div>
            <div class="col-md-6 {{genColClass model.page.page_type index true model.unit.color_scheme}} oik-col">
                {{oik-md text=row.left_markdown editable=true edit=doEdit image=row.leftImage has_image=row.left_has_image selectImage=(action "selectImage")}}
            </div>
            <div class="col-md-6 {{genColClass model.page.page_type index false model.unit.color_scheme}} oik-col">
                {{oik-md text=row.right_markdown editable=true edit=doEdit image=row.rightImage has_image=row.right_has_image selectImage=(action "selectImage")}}
            </div>
        </div>
    {{/each}}
    <hr>
    <div class="row">
        <div class="col-md-12">
            {{#if model.page.extendable}}
                <button {{action "addRow"}} class="btn btn-sm btn-default">Neue Zeile</button>
            {{/if}}
            <div class="btn-toolbar pull-right">
                <button {{action "save"}} class="btn btn-sm btn-primary">Speichern</button>
                {{#if (startsWith model.page.page_type "critic")}}
                    <button {{action "saveAndExit"}} class="btn btn-sm btn-primary">Speichern und Ende</button>
                {{else}}
                    {{#if (startsWith model.page.page_type "hearing")}}
                        {{#if (isLast model.page model.unit.pages)}}
                            <button {{action "saveAndSynthesis"}} class="btn btn-sm btn-primary">Speichern und Synthese</button>
                        {{/if}}
                    {{/if}}
                    <button {{action "saveAndNext"}} class="btn btn-sm btn-primary">Speichern und weiter</button>
                {{/if}}
            </div>
            {{#if (startsWith model.page.page_type "opening")}}
            {{else}}
                <button {{action "prevPage"}} class="btn btn-sm pull-left">Zurück</button>
            {{/if}}
        </div>
    </div>
</div>

<!-- select image modal -->
<div class="modal fade" id="select-image-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">Bild auswählen</h4>
            </div>
            <div class="modal-body">
                <div class="row equal">
                    {{#if model.unit.images}}
                        {{#each model.unit.images as |image|}}
                            <div class="col-md-4 selectable-image text-center unit-preview {{if image.selected "selected" ""}}">
                                <a {{action "doSelectImage" image}}>
                                    <img src="{{image.blobUrl}}" class="full-width-image">
                                    <br>
                                    {{image.caption}}
                                </a>
                            </div>
                        {{/each}}
                    {{/if}}
                    <div class="col-md-4 selectable-image text-center unit-preview {{if image.selected "selected" ""}}">
                        <a {{action "newUploadImage"}}>
                            <img src="images/new_image.jpg" class="full-width-image">
                            <br>
                            Neues Bild 
                        </a>
                    </div>
                </div>
                {{#if currentImage}}
                <hr>
                {{#if isNewImage}}
                    <p><b>Neues Bild hochladen</b></p>
                {{else}}
                    <p><b>Bild editieren</b></p>
                {{/if}}
                <div class="row">
                    <div class="col-md-12">
                        <form>
                            <div class="form-group">
                                <label for="inputCredits">Credits</label>
                                {{input type="text" class="form-control" id="inputCredits" placeholder="Credits" value=currentImage.credits}}
                            </div>
                            <div class="form-group">
                                <label for="inputCaption">Caption</label>
                                {{input type="text" class="form-control" id="inputCaption" placeholder="Caption" value=currentImage.caption}}
                            </div>
                        </form>
                        {{#if isNewImage}}
                            <label for="inputFile">Datei</label>
                            {{#x-file-input name="files" id="inputFile" multiple=false action=(action "didSelectFiles") alt="Datei auswählen"}}
                                <button class="btn btn-sm btn-default">Datei auswählen</button>
                            {{/x-file-input}}
                            <button {{action "doUpload"}} class="btn btn-sm btn-primary pull-right">Starte Upload!</button>
                        {{else}}
                            <button {{action "saveCurrentImage"}} class="btn btn-sm btn-default pull-right">Änderungen speichern</button>
                        {{/if}}
                    </div>
                </div>
                {{/if}}
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Abbrechen</button>
                <button {{action 'resolveImagePromise'}} type="button" class="btn btn-primary">Auswahl bestätigen</button>
            </div>
        </div>
    </div>
</div>

{{outlet}}
